import{r,q as P,j as t,v as h,n as x,I as g,h as A,C as S,t as N}from"./index-CV1bxkLI.js";import{P as U}from"./PageHeader-Dveo8Ckr.js";import{D as M}from"./DataTable-BML9nD9J.js";import{F as q}from"./FormModal-DDGPMrd0.js";import{c as V,d as R}from"./mockData-DhN2TBgL.js";import{d as _}from"./downloadHelper-BRzppvwq.js";/* empty css                 */import{F as o}from"./index-ChYIY3iE.js";import{C as O}from"./index-CJpspubW.js";import{T as B}from"./index-CMSFhQ_d.js";import{S as K}from"./index-ChaAteEr.js";import"./ReloadOutlined-D_5bXhqo.js";import"./index-D8x57Z7c.js";import"./Table-CQO6drIt.js";import"./index-BHUsVD3h.js";import"./useForm-Dj05K5iH.js";const u=V(R),oe=()=>{const[b,d]=r.useState([]),[y,f]=r.useState(!0),[v,c]=r.useState(!1),[l,C]=r.useState(null),[i]=o.useForm(),{showSuccess:n,showError:m}=P(),j=async()=>{f(!0);try{const e=await u.getAll();d(e.data)}catch{m("Failed to fetch courses")}finally{f(!1)}};r.useEffect(()=>{j()},[]);const w=r.useMemo(()=>[{title:"Course Name",dataIndex:"name",key:"name",sorter:(e,s)=>e.name.localeCompare(s.name)},{title:"Code",dataIndex:"code",key:"code",width:100,render:e=>t.jsx(x,{color:"blue",children:e})},{title:"Credits",dataIndex:"credits",key:"credits",width:80,sorter:(e,s)=>e.credits-s.credits,align:"center"},{title:"Type",dataIndex:"type",key:"type",width:150,filters:h.map(e=>({text:e.label,value:e.value})),onFilter:(e,s)=>s.type===e,render:e=>{const s=h.find(a=>a.value===e);return t.jsx(x,{children:(s==null?void 0:s.label)||e})}},{title:"Status",dataIndex:"status",key:"status",width:100,render:e=>t.jsx(x,{color:e==="active"?"success":"default",children:e.charAt(0).toUpperCase()+e.slice(1)})}],[]),I=()=>{C(null),i.resetFields(),c(!0)},T=e=>{C(e),i.setFieldsValue(e),c(!0)},F=async e=>{try{await u.delete(e.id),d(s=>s.filter(a=>a.id!==e.id)),n("Course deleted successfully")}catch{m("Failed to delete course")}},k=async e=>{try{if(l){const s=await u.update(l.id,e);d(a=>a.map(p=>p.id===l.id?{...p,...s.data}:p)),n("Course updated successfully")}else{const s=await u.create(e);d(a=>[...a,s.data]),n("Course created successfully")}c(!1),i.resetFields()}catch{m("Failed to save course")}},E=()=>{_("/templates/courses_template.csv","courses_template.csv"),n("Template download started")},D=[{key:"list",label:"Course List",children:t.jsx(M,{tableId:"courses",columns:w,dataSource:b,loading:y,searchKeys:["name","code"],onEdit:T,onDelete:F,emptyText:"No Courses Found",emptyDescription:"Start by adding your first course."})},{key:"upload",label:"Bulk Upload",children:t.jsx("div",{style:{padding:24},children:t.jsx(BulkUpload,{onUpload:async e=>new Promise(s=>setTimeout(()=>s({success:!0,message:"Courses imported"}),1e3)),onDownloadTemplate:E,templateName:"courses_template.csv",title:"Upload Courses",description:"Upload an Excel or CSV file"})})}];return t.jsxs("div",{className:"crud-page",children:[t.jsx(U,{title:"Course Master",subtitle:"Manage courses and subjects",onAdd:I,addText:"Add Course",onRefresh:j,loading:y}),t.jsx(O,{className:"content-card",children:t.jsx(Tabs,{items:D,defaultActiveKey:"list",style:{marginTop:-16}})}),t.jsxs(q,{title:l?"Edit Course":"Add New Course",open:v,onClose:()=>c(!1),onSubmit:k,form:i,initialValues:l||{status:"active",credits:3,type:"theory"},width:600,children:[t.jsx(o.Item,{name:"name",label:"Course Name",rules:[{required:!0,message:"Please enter course name"}],children:t.jsx(g,{placeholder:"e.g., Data Structures"})}),t.jsxs(A,{gutter:16,children:[t.jsx(S,{span:12,children:t.jsx(o.Item,{name:"code",label:"Course Code",rules:[{required:!0,message:"Please enter course code"}],children:t.jsx(g,{placeholder:"e.g., CS201",style:{textTransform:"uppercase"}})})}),t.jsx(S,{span:12,children:t.jsx(o.Item,{name:"credits",label:"Credits",rules:[{required:!0,message:"Please enter credits"}],children:t.jsx(B,{min:1,max:10,style:{width:"100%"}})})})]}),t.jsx(o.Item,{name:"type",label:"Course Type",rules:[{required:!0,message:"Please select course type"}],children:t.jsx(N,{placeholder:"Select course type",options:h})}),t.jsx(o.Item,{name:"status",label:"Status",valuePropName:"checked",getValueFromEvent:e=>e?"active":"inactive",getValueProps:e=>({checked:e==="active"}),children:t.jsx(K,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})]})};export{oe as default};
