import{r as l,q as R,j as s,n as j,B as u,O as $,G as z,h as M,C as v,T as P,A as q,t as w,I as V}from"./index-CV1bxkLI.js";import{P as G}from"./PageHeader-Dveo8Ckr.js";import{F as H}from"./FormModal-DDGPMrd0.js";import{d as K,j as S,c as W,k as _}from"./mockData-DhN2TBgL.js";/* empty css                 */import{F as m}from"./index-ChYIY3iE.js";import{C as F}from"./index-CJpspubW.js";import{F as J}from"./Table-CQO6drIt.js";import"./ReloadOutlined-D_5bXhqo.js";import"./useForm-Dj05K5iH.js";import"./index-BHUsVD3h.js";const{Text:C}=P,p=W(_),ae=()=>{const[k,N]=l.useState(!0),[r,y]=l.useState(null),[b,n]=l.useState([]),[A,d]=l.useState(!1),[a,g]=l.useState(null),[i]=m.useForm(),{showSuccess:h,showError:x}=R(),c=K.slice(0,5);l.useEffect(()=>{(async()=>{try{const t=await p.getAll();n(t.data)}catch{x("Failed to fetch course outcomes")}finally{N(!1)}})(),c.length>0&&y(c[0].id)},[]);const I=b.filter(e=>e.courseId===r),L=l.useMemo(()=>[{title:"CO Number",dataIndex:"coNumber",key:"coNumber",width:100,render:e=>s.jsxs(j,{color:"blue",children:["CO",e]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Bloom Level",dataIndex:"bloomLevelId",key:"bloomLevelId",width:150,render:e=>{const t=S.find(o=>o.id===e);return t?s.jsx(j,{color:"purple",children:t.name}):"-"}},{title:"Actions",key:"actions",width:100,render:(e,t)=>s.jsxs(u.Group,{size:"small",children:[s.jsx(u,{type:"text",icon:s.jsx($,{}),onClick:()=>D(t)}),s.jsx(u,{type:"text",danger:!0,icon:s.jsx(z,{}),onClick:()=>E(t)})]})}],[]),T=()=>{g(null),i.resetFields(),i.setFieldsValue({courseId:r}),d(!0)},D=e=>{g(e),i.setFieldsValue(e),d(!0)},E=async e=>{try{await p.delete(e.id),n(t=>t.filter(o=>o.id!==e.id)),h("Course outcome deleted")}catch{x("Failed to delete")}},B=async e=>{try{if(a){const t=await p.update(a.id,e);n(o=>o.map(f=>f.id===a.id?{...f,...t.data}:f)),h("Course outcome updated")}else{const t=await p.create({...e,courseId:r});n(o=>[...o,t.data]),h("Course outcome added")}d(!1),i.resetFields()}catch{x("Failed to save")}},O=c.find(e=>e.id===r);return s.jsxs("div",{className:"crud-page",children:[s.jsx(G,{title:"Course Outcomes",subtitle:"Define learning outcomes for your courses",showAdd:!1,showRefresh:!1}),s.jsxs(M,{gutter:24,children:[s.jsx(v,{xs:24,md:8,children:s.jsx(F,{title:"My Courses",size:"small",children:c.map(e=>s.jsxs("div",{className:`mapping-item ${r===e.id?"selected":""}`,onClick:()=>y(e.id),children:[s.jsxs("div",{children:[s.jsx(C,{strong:!0,children:e.name}),s.jsx("br",{}),s.jsx(C,{type:"secondary",style:{fontSize:12},children:e.code})]}),s.jsxs(j,{children:[b.filter(t=>t.courseId===e.id).length," COs"]})]},e.id))})}),s.jsx(v,{xs:24,md:16,children:s.jsx(F,{title:s.jsxs("span",{children:["Course Outcomes",O&&s.jsxs(C,{type:"secondary",style:{fontWeight:"normal",marginLeft:8},children:["for ",O.name]})]}),extra:s.jsx(u,{type:"primary",icon:s.jsx(q,{}),onClick:T,disabled:!r,children:"Add CO"}),size:"small",children:s.jsx(J,{dataSource:I,columns:L,rowKey:"id",loading:k,pagination:!1,size:"small",locale:{emptyText:"No course outcomes defined for this course"}})})})]}),s.jsxs(H,{title:a?"Edit Course Outcome":"Add Course Outcome",open:A,onClose:()=>d(!1),onSubmit:B,form:i,initialValues:a||{coNumber:I.length+1},children:[s.jsx(m.Item,{name:"coNumber",label:"CO Number",rules:[{required:!0,message:"Please enter CO number"}],children:s.jsx(w,{placeholder:"Select CO number",options:[1,2,3,4,5,6].map(e=>({value:e,label:`CO${e}`}))})}),s.jsx(m.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter CO description"}],children:s.jsx(V.TextArea,{rows:3,placeholder:"Describe what students will be able to do after completing this course"})}),s.jsx(m.Item,{name:"bloomLevelId",label:"Bloom's Taxonomy Level",rules:[{required:!0,message:"Please select Bloom level"}],children:s.jsx(w,{placeholder:"Select Bloom level",options:S.map(e=>({value:e.id,label:`${e.name} (Level ${e.level})`}))})})]})]})};export{ae as default};
