import{r as i,g as G,_ as J,b8 as q,j as s,S as Q,M as V,B as z,b9 as U,O as Y,G as Z,E as L,ba as v,I as X,bb as K,d as W,bc as ee}from"./index-CV1bxkLI.js";import{P as te}from"./index-D8x57Z7c.js";import{F as ae}from"./Table-CQO6drIt.js";var se={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6a25.95 25.95 0 0025.6 30.4h723c1.5 0 3-.1 4.4-.4a25.88 25.88 0 0021.2-30zM204 390h272V182h72v208h272v104H204V390zm468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"}}]},name:"clear",theme:"outlined"},re=function(m,f){return i.createElement(G,J({},m,{ref:f,icon:se}))},ie=i.forwardRef(re);const ne=(j,m={})=>{const{defaultFilters:f={},defaultSorter:S=null,defaultPageSize:T=q,persistFilters:c=!0}=m,o=`table_filters_${j}`,p=()=>{if(c)try{const t=sessionStorage.getItem(o);if(t)return JSON.parse(t)}catch{}return{filters:f,sorter:S,pagination:{current:1,pageSize:T},searchText:""}},[r,l]=i.useState(p);i.useEffect(()=>{if(c)try{sessionStorage.setItem(o,JSON.stringify(r))}catch{}},[r,o,c]);const y=i.useCallback(t=>{l(e=>({...e,filters:typeof t=="function"?t(e.filters):{...e.filters,...t},pagination:{...e.pagination,current:1}}))},[]),I=i.useCallback((t,e)=>{l(a=>({...a,filters:{...a.filters,[t]:e},pagination:{...a.pagination,current:1}}))},[]),E=i.useCallback(t=>{l(e=>{const a={...e.filters};return delete a[t],{...e,filters:a,pagination:{...e.pagination,current:1}}})},[]),w=i.useCallback(t=>{l(e=>({...e,sorter:t}))},[]),P=i.useCallback(t=>{l(e=>({...e,pagination:typeof t=="function"?t(e.pagination):{...e.pagination,...t}}))},[]),A=i.useCallback(t=>{l(e=>({...e,searchText:t,pagination:{...e.pagination,current:1}}))},[]),O=i.useCallback((t,e,a)=>{l(u=>({...u,pagination:{current:t.current,pageSize:t.pageSize},filters:{...u.filters,...e},sorter:a.order?{field:a.field,order:a.order}:null}))},[]),C=i.useCallback(()=>{l({filters:f,sorter:S,pagination:{current:1,pageSize:T},searchText:""})},[f,S,T]),_=i.useCallback(()=>{c&&sessionStorage.removeItem(o),C()},[o,c,C]),D=i.useMemo(()=>Object.values(r.filters).some(e=>e!=null&&e!==""&&(!Array.isArray(e)||e.length>0))||r.searchText!=="",[r.filters,r.searchText]),H=i.useCallback((t,e=[])=>{var u,N;let a=[...t];if(r.searchText&&e.length>0){const d=r.searchText.toLowerCase();a=a.filter(n=>e.some(h=>{const x=n[h];return x&&x.toString().toLowerCase().includes(d)}))}if(Object.entries(r.filters).forEach(([d,n])=>{n!=null&&n!==""&&(Array.isArray(n)&&n.length>0?a=a.filter(h=>n.includes(h[d])):a=a.filter(h=>h[d]===n))}),(u=r.sorter)!=null&&u.field&&((N=r.sorter)!=null&&N.order)){const{field:d,order:n}=r.sorter;a.sort((h,x)=>{const F=h[d],k=x[d];return F<k?n==="ascend"?-1:1:F>k?n==="ascend"?1:-1:0})}return a},[r.searchText,r.filters,r.sorter]),M=i.useCallback(t=>{const{current:e,pageSize:a}=r.pagination,u=(e-1)*a;return t.slice(u,u+a)},[r.pagination]);return{filters:r.filters,sorter:r.sorter,pagination:r.pagination,searchText:r.searchText,hasActiveFilters:D,setFilters:y,setFilter:I,clearFilter:E,setSorter:w,setPagination:P,setSearchText:A,handleTableChange:O,resetFilters:C,clearStorage:_,getFilteredData:H,getPaginatedData:M}},ue=({tableId:j,columns:m,dataSource:f,loading:S=!1,rowKey:T="id",onEdit:c,onDelete:o,onView:p,searchKeys:r=[],showSearch:l=!0,showActions:y=!0,actionWidth:I=120,emptyText:E,emptyDescription:w,scroll:P,rowSelection:A,expandable:O,size:C="middle",bordered:_=!1,sticky:D=!0,...H})=>{var $;const[M,t]=i.useState(""),{pagination:e,hasActiveFilters:a,setSearchText:u,handleTableChange:N,resetFilters:d,getFilteredData:n}=ne(j,{defaultPageSize:10,persistFilters:!0}),h=i.useMemo(()=>{const g=[...m];return y&&(c||o||p)&&g.push({title:"Actions",key:"actions",fixed:"right",width:I,render:(b,R)=>s.jsxs(Q,{size:"small",children:[p&&s.jsx(V,{title:"View",children:s.jsx(z,{type:"text",size:"small",icon:s.jsx(U,{}),onClick:()=>p(R),className:"action-btn view-btn","aria-label":"View record"})}),c&&s.jsx(V,{title:"Edit",children:s.jsx(z,{type:"text",size:"small",icon:s.jsx(Y,{}),onClick:()=>c(R),className:"action-btn edit-btn","aria-label":"Edit record"})}),o&&s.jsx(te,{title:"Delete this record?",description:"This action cannot be undone.",onConfirm:()=>o(R),okText:"Delete",cancelText:"Cancel",okButtonProps:{danger:!0},children:s.jsx(V,{title:"Delete",children:s.jsx(z,{type:"text",size:"small",icon:s.jsx(Z,{}),className:"action-btn delete-btn","aria-label":"Delete record"})})})]})}),g},[m,y,I,c,o,p]),x=i.useMemo(()=>n(f,r),[f,n,r]),F=g=>{u(g)},k=g=>{const b=g.target.value;t(b),clearTimeout(window.searchTimeout),window.searchTimeout=setTimeout(()=>{F(b)},300)},B=s.jsx(L,{image:L.PRESENTED_IMAGE_SIMPLE,description:s.jsxs("div",{className:"table-empty-state",children:[s.jsx("p",{className:"empty-title",children:E||v.questions.title}),s.jsx("p",{className:"empty-description",children:w||v.questions.description})]})});return s.jsxs("div",{className:"data-table-container",children:[(l||a)&&s.jsxs("div",{className:"table-toolbar",children:[s.jsx("div",{className:"toolbar-left",children:l&&s.jsx(X,{placeholder:"Search...",prefix:s.jsx(K,{style:{color:($=W.text)==null?void 0:$.tertiary}}),value:M,onChange:k,allowClear:!0,className:"table-search",style:{width:280},"aria-label":"Search table"})}),s.jsx("div",{className:"toolbar-right",children:a&&s.jsx(z,{icon:s.jsx(ie,{}),onClick:()=>{d(),t("")},children:"Clear Filters"})})]}),s.jsx(ae,{columns:h,dataSource:x,loading:S,rowKey:T,size:C,bordered:_,locale:{emptyText:B},rowSelection:A,expandable:O,scroll:P||{x:"max-content"},sticky:D,pagination:{...e,total:x.length,showSizeChanger:!0,showQuickJumper:!0,pageSizeOptions:ee,showTotal:(g,b)=>s.jsxs("span",{className:"pagination-total",children:["Showing ",b[0],"-",b[1]," of ",g," records"]})},onChange:N,className:"data-table",...H})]})};export{ue as D};
