import{r as s,q as A,j as t,n as y,I as v}from"./index-CV1bxkLI.js";import{P as C}from"./PageHeader-Dveo8Ckr.js";import{D}from"./DataTable-BML9nD9J.js";import{F as E}from"./FormModal-DDGPMrd0.js";import{c as k,r as N}from"./mockData-DhN2TBgL.js";/* empty css                 */import{F as o}from"./index-ChYIY3iE.js";import{C as T}from"./index-CJpspubW.js";import{T as P}from"./index-CMSFhQ_d.js";import{S as M}from"./index-ChaAteEr.js";import"./ReloadOutlined-D_5bXhqo.js";import"./index-D8x57Z7c.js";import"./Table-CQO6drIt.js";import"./index-BHUsVD3h.js";import"./useForm-Dj05K5iH.js";const d=k(N),Z=()=>{const[j,l]=s.useState([]),[h,g]=s.useState(!0),[S,n]=s.useState(!1),[r,f]=s.useState(null),[c]=o.useForm(),{showSuccess:u,showError:m}=A(),x=async()=>{g(!0);try{const e=await d.getAll();l(e.data)}catch{m("Failed to fetch regulations")}finally{g(!1)}};s.useEffect(()=>{x()},[]);const F=s.useMemo(()=>[{title:"Regulation Name",dataIndex:"name",key:"name",sorter:(e,a)=>e.name.localeCompare(a.name),render:(e,a)=>t.jsxs("div",{children:[t.jsx("strong",{children:e}),t.jsx("div",{style:{fontSize:12,color:"var(--color-text-tertiary)"},children:a.description})]})},{title:"Year",dataIndex:"year",key:"year",width:100,sorter:(e,a)=>e.year-a.year,render:e=>t.jsx(y,{color:"blue",children:e})},{title:"Status",dataIndex:"status",key:"status",width:100,filters:[{text:"Active",value:"active"},{text:"Inactive",value:"inactive"}],onFilter:(e,a)=>a.status===e,render:e=>t.jsx(y,{color:e==="active"?"success":"default",children:e.charAt(0).toUpperCase()+e.slice(1)})}],[]),I=()=>{f(null),c.resetFields(),n(!0)},R=e=>{f(e),c.setFieldsValue(e),n(!0)},w=async e=>{try{await d.delete(e.id),l(a=>a.filter(i=>i.id!==e.id)),u("Regulation deleted successfully")}catch{m("Failed to delete regulation")}},b=async e=>{try{if(r){const a=await d.update(r.id,e);l(i=>i.map(p=>p.id===r.id?{...p,...a.data}:p)),u("Regulation updated successfully")}else{const a=await d.create(e);l(i=>[...i,a.data]),u("Regulation created successfully")}n(!1),c.resetFields()}catch{m("Failed to save regulation")}};return t.jsxs("div",{className:"crud-page",children:[t.jsx(C,{title:"Regulations",subtitle:"Manage academic regulations and curricula versions",onAdd:I,addText:"Add Regulation",onRefresh:x,loading:h}),t.jsx(T,{className:"content-card",children:t.jsx(D,{tableId:"regulations",columns:F,dataSource:j,loading:h,searchKeys:["name","description"],onEdit:R,onDelete:w,emptyText:"No Regulations Found",emptyDescription:"Start by adding your first regulation."})}),t.jsxs(E,{title:r?"Edit Regulation":"Add New Regulation",open:S,onClose:()=>n(!1),onSubmit:b,form:c,initialValues:r||{status:"active",year:new Date().getFullYear()},children:[t.jsx(o.Item,{name:"name",label:"Regulation Name",rules:[{required:!0,message:"Please enter regulation name"}],children:t.jsx(v,{placeholder:"e.g., R20"})}),t.jsx(o.Item,{name:"year",label:"Year",rules:[{required:!0,message:"Please enter year"}],children:t.jsx(P,{min:2e3,max:2100,style:{width:"100%"},placeholder:"e.g., 2020"})}),t.jsx(o.Item,{name:"description",label:"Description",children:t.jsx(v.TextArea,{rows:3,placeholder:"Brief description of the regulation"})}),t.jsx(o.Item,{name:"status",label:"Status",valuePropName:"checked",getValueFromEvent:e=>e?"active":"inactive",getValueProps:e=>({checked:e==="active"}),children:t.jsx(M,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})]})};export{Z as default};
