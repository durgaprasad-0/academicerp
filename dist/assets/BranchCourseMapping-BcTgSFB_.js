import{r as o,n as z,j as e,ax as B,B as b,az as k}from"./index-Dam5Oft4.js";import{P as $}from"./PageHeader-CZTgCyCQ.js";import{F as L}from"./FormModal-DAw8X4uI.js";import{g as N,b as i,d as C,r as I}from"./mockData-Cb9OjNPh.js";/* empty css                 */import{F as n}from"./index-BKD578Au.js";import{R as q,a as w,C as M,T as _,c as O}from"./index-FCt6_Que.js";import{L as R}from"./index-DLj7NG8w.js";import{T as m}from"./index-B2mNOki0.js";import{F as D}from"./Table-C6DyXLPW.js";import{E as H,S as p}from"./Pagination-Uk28cVne.js";import{P as K}from"./index-DuDzpR4g.js";import{R as W}from"./DeleteOutlined-B7Ves8ci.js";import"./ReloadOutlined-DwAtovzj.js";import"./index-B4TLLAPK.js";import"./useForm-Boa0LRH0.js";import"./index-CrsKlaQM.js";const{Text:u}=_,ce=()=>{var y;const[v,E]=o.useState(!0),[a,h]=o.useState(null),[g,l]=o.useState([]),[F,d]=o.useState(!1),[x]=n.useForm(),{showSuccess:f,showError:G}=z();o.useEffect(()=>{l(N),E(!1),i.length>0&&h(i[0].id)},[]);const j=g.filter(s=>s.branchId===a),A=[{title:"Course",key:"course",render:(s,r)=>{const t=C.find(c=>c.id===r.courseId);return t?`${t.name} (${t.code})`:"-"}},{title:"Semester",dataIndex:"semester",key:"semester",width:120,render:s=>e.jsxs(m,{color:"blue",children:["Semester ",s]})},{title:"Regulation",key:"regulation",width:120,render:(s,r)=>{const t=I.find(c=>c.id===r.regulationId);return t?e.jsx(m,{children:t.name}):"-"}},{title:"Action",key:"action",width:80,render:(s,r)=>e.jsx(K,{title:"Remove this mapping?",onConfirm:()=>P(r.id),children:e.jsx(b,{type:"text",danger:!0,icon:e.jsx(W,{}),size:"small"})})}],P=s=>{l(r=>r.filter(t=>t.id!==s)),f("Mapping removed")},T=async s=>{const r={id:Date.now(),branchId:a,...s};l(t=>[...t,r]),d(!1),x.resetFields(),f("Course mapped successfully")},S=C.filter(s=>!j.some(r=>r.courseId===s.id));return v?e.jsx("div",{className:"crud-page",style:{textAlign:"center",padding:100},children:e.jsx(B,{size:"large"})}):e.jsxs("div",{className:"crud-page",children:[e.jsx($,{title:"Branch-Course Mapping",subtitle:"Assign courses to branches with semester allocation",showAdd:!1,showRefresh:!1}),e.jsxs(q,{gutter:24,children:[e.jsx(w,{xs:24,md:8,children:e.jsx(M,{title:"Branches",size:"small",children:e.jsx(R,{dataSource:i,renderItem:s=>e.jsxs(R.Item,{className:`mapping-item ${a===s.id?"selected":""}`,onClick:()=>h(s.id),children:[e.jsxs("div",{children:[e.jsx(u,{strong:!0,children:s.name}),e.jsx("br",{}),e.jsx(u,{type:"secondary",style:{fontSize:12},children:s.code})]}),e.jsxs(m,{color:"green",children:[g.filter(r=>r.branchId===s.id).length," courses"]})]})})})}),e.jsx(w,{xs:24,md:16,children:e.jsx(M,{title:e.jsxs("span",{children:["Mapped Courses",a&&e.jsxs(u,{type:"secondary",style:{fontWeight:"normal",marginLeft:8},children:["for ",(y=i.find(s=>s.id===a))==null?void 0:y.name]})]}),extra:e.jsx(b,{type:"primary",icon:e.jsx(O,{}),onClick:()=>d(!0),disabled:!a||S.length===0,children:"Add Course"}),size:"small",children:a?e.jsx(D,{dataSource:j,columns:A,rowKey:"id",pagination:!1,size:"small",locale:{emptyText:"No courses mapped to this branch"}}):e.jsx(H,{description:"Select a branch to view mapped courses"})})})]}),e.jsxs(L,{title:"Add Course Mapping",open:F,onClose:()=>d(!1),onSubmit:T,form:x,children:[e.jsx(n.Item,{name:"courseId",label:"Course",rules:[{required:!0,message:"Please select a course"}],children:e.jsx(p,{placeholder:"Select course",options:S.map(s=>({value:s.id,label:`${s.name} (${s.code})`})),showSearch:!0,optionFilterProp:"label"})}),e.jsx(n.Item,{name:"semester",label:"Semester",rules:[{required:!0,message:"Please select semester"}],children:e.jsx(p,{placeholder:"Select semester",options:k})}),e.jsx(n.Item,{name:"regulationId",label:"Regulation",rules:[{required:!0,message:"Please select regulation"}],children:e.jsx(p,{placeholder:"Select regulation",options:I.filter(s=>s.status==="active").map(s=>({value:s.id,label:s.name}))})})]})]})};export{ce as default};
