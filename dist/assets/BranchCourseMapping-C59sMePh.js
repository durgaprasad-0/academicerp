import{r as o,q as T,j as e,y as k,h as z,C as b,L as C,T as $,n as m,E as q,B as I,A as L,t as p,F as N,G as _}from"./index-CV1bxkLI.js";import{P as O}from"./PageHeader-Dveo8Ckr.js";import{F as D}from"./FormModal-DDGPMrd0.js";import{g as G,b as n,d as w,r as M}from"./mockData-DhN2TBgL.js";/* empty css                 */import{F as i}from"./index-ChYIY3iE.js";import{C as v}from"./index-CJpspubW.js";import{F as H}from"./Table-CQO6drIt.js";import{P as K}from"./index-D8x57Z7c.js";import"./ReloadOutlined-D_5bXhqo.js";import"./useForm-Dj05K5iH.js";import"./index-BHUsVD3h.js";const{Text:u}=$,oe=()=>{var y;const[F,R]=o.useState(!0),[a,h]=o.useState(null),[g,l]=o.useState([]),[A,d]=o.useState(!1),[x]=i.useForm(),{showSuccess:f,showError:W}=T();o.useEffect(()=>{l(G),R(!1),n.length>0&&h(n[0].id)},[]);const j=g.filter(s=>s.branchId===a),E=[{title:"Course",key:"course",render:(s,r)=>{const t=w.find(c=>c.id===r.courseId);return t?`${t.name} (${t.code})`:"-"}},{title:"Semester",dataIndex:"semester",key:"semester",width:120,render:s=>e.jsxs(m,{color:"blue",children:["Semester ",s]})},{title:"Regulation",key:"regulation",width:120,render:(s,r)=>{const t=M.find(c=>c.id===r.regulationId);return t?e.jsx(m,{children:t.name}):"-"}},{title:"Action",key:"action",width:80,render:(s,r)=>e.jsx(K,{title:"Remove this mapping?",onConfirm:()=>P(r.id),children:e.jsx(I,{type:"text",danger:!0,icon:e.jsx(_,{}),size:"small"})})}],P=s=>{l(r=>r.filter(t=>t.id!==s)),f("Mapping removed")},B=async s=>{const r={id:Date.now(),branchId:a,...s};l(t=>[...t,r]),d(!1),x.resetFields(),f("Course mapped successfully")},S=w.filter(s=>!j.some(r=>r.courseId===s.id));return F?e.jsx("div",{className:"crud-page",style:{textAlign:"center",padding:100},children:e.jsx(k,{size:"large"})}):e.jsxs("div",{className:"crud-page",children:[e.jsx(O,{title:"Branch-Course Mapping",subtitle:"Assign courses to branches with semester allocation",showAdd:!1,showRefresh:!1}),e.jsxs(z,{gutter:24,children:[e.jsx(b,{xs:24,md:8,children:e.jsx(v,{title:"Branches",size:"small",children:e.jsx(C,{dataSource:n,renderItem:s=>e.jsxs(C.Item,{className:`mapping-item ${a===s.id?"selected":""}`,onClick:()=>h(s.id),children:[e.jsxs("div",{children:[e.jsx(u,{strong:!0,children:s.name}),e.jsx("br",{}),e.jsx(u,{type:"secondary",style:{fontSize:12},children:s.code})]}),e.jsxs(m,{color:"green",children:[g.filter(r=>r.branchId===s.id).length," courses"]})]})})})}),e.jsx(b,{xs:24,md:16,children:e.jsx(v,{title:e.jsxs("span",{children:["Mapped Courses",a&&e.jsxs(u,{type:"secondary",style:{fontWeight:"normal",marginLeft:8},children:["for ",(y=n.find(s=>s.id===a))==null?void 0:y.name]})]}),extra:e.jsx(I,{type:"primary",icon:e.jsx(L,{}),onClick:()=>d(!0),disabled:!a||S.length===0,children:"Add Course"}),size:"small",children:a?e.jsx(H,{dataSource:j,columns:E,rowKey:"id",pagination:!1,size:"small",locale:{emptyText:"No courses mapped to this branch"}}):e.jsx(q,{description:"Select a branch to view mapped courses"})})})]}),e.jsxs(D,{title:"Add Course Mapping",open:A,onClose:()=>d(!1),onSubmit:B,form:x,children:[e.jsx(i.Item,{name:"courseId",label:"Course",rules:[{required:!0,message:"Please select a course"}],children:e.jsx(p,{placeholder:"Select course",options:S.map(s=>({value:s.id,label:`${s.name} (${s.code})`})),showSearch:!0,optionFilterProp:"label"})}),e.jsx(i.Item,{name:"semester",label:"Semester",rules:[{required:!0,message:"Please select semester"}],children:e.jsx(p,{placeholder:"Select semester",options:N})}),e.jsx(i.Item,{name:"regulationId",label:"Regulation",rules:[{required:!0,message:"Please select regulation"}],children:e.jsx(p,{placeholder:"Select regulation",options:M.filter(s=>s.status==="active").map(s=>({value:s.id,label:s.name}))})})]})]})};export{oe as default};
