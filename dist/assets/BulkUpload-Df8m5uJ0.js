import{r as l,g,_ as j,j as e,B as f,d as I,aR as w,aS as E,S as H}from"./index-Dam5Oft4.js";import{T as L}from"./index-FCt6_Que.js";import{R as O}from"./DownloadOutlined-BqSPMs8z.js";import{U as N}from"./index-CIaEzPBK.js";import{P as B}from"./progress-DnPM2Sxy.js";import{A as M}from"./index-D3Ga-QO6.js";import{M as $}from"./index-B4TLLAPK.js";var C={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM514.1 580.1l-61.8-102.4c-2.2-3.6-6.1-5.8-10.3-5.8h-38.4c-2.3 0-4.5.6-6.4 1.9-5.6 3.5-7.3 10.9-3.7 16.6l82.3 130.4-83.4 132.8a12.04 12.04 0 0010.2 18.4h34.5c4.2 0 8-2.2 10.2-5.7L510 664.8l62.3 101.4c2.2 3.6 6.1 5.7 10.2 5.7H620c2.3 0 4.5-.7 6.5-1.9 5.6-3.6 7.2-11 3.6-16.6l-84-130.4 85.3-132.5a12.04 12.04 0 00-10.1-18.5h-35.7c-4.2 0-8.1 2.2-10.3 5.8l-61.2 102.3z"}}]},name:"file-excel",theme:"outlined"},k=function(r,c){return l.createElement(g,j({},r,{ref:c,icon:C}))},P=l.forwardRef(k),T={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M885.2 446.3l-.2-.8-112.2-285.1c-5-16.1-19.9-27.2-36.8-27.2H281.2c-17 0-32.1 11.3-36.9 27.6L139.4 443l-.3.7-.2.8c-1.3 4.9-1.7 9.9-1 14.8-.1 1.6-.2 3.2-.2 4.8V830a60.9 60.9 0 0060.8 60.8h627.2c33.5 0 60.8-27.3 60.9-60.8V464.1c0-1.3 0-2.6-.1-3.7.4-4.9 0-9.6-1.3-14.1zm-295.8-43l-.3 15.7c-.8 44.9-31.8 75.1-77.1 75.1-22.1 0-41.1-7.1-54.8-20.6S436 441.2 435.6 419l-.3-15.7H229.5L309 210h399.2l81.7 193.3H589.4zm-375 76.8h157.3c24.3 57.1 76 90.8 140.4 90.8 33.7 0 65-9.4 90.3-27.2 22.2-15.6 39.5-37.4 50.7-63.6h156.5V814H214.4V480.1z"}}]},name:"inbox",theme:"outlined"},D=function(r,c){return l.createElement(g,j({},r,{ref:c,icon:T}))},_=l.forwardRef(D),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"},G=function(r,c){return l.createElement(g,j({},r,{ref:c,icon:A}))},ee=l.forwardRef(G);const{Dragger:K}=N,{Text:d}=L,se=({onUpload:u,onDownloadTemplate:r,accept:c=".xlsx,.xls,.csv",maxSize:v=5,templateName:R="template.xlsx",title:U="Upload File",description:z="Click or drag file to this area to upload",hint:S="Support for Excel (.xlsx, .xls) and CSV files"})=>{const[t,p]=l.useState([]),[h,y]=l.useState(!1),[V,m]=l.useState(0),[a,n]=l.useState(null),b=async()=>{if(t.length!==0){y(!0),m(0),n(null);try{const s=new FormData;s.append("file",t[0]);const i=setInterval(()=>{m(x=>x>=90?(clearInterval(i),x):x+10)},200),o=await u(s);clearInterval(i),m(100),n({success:!0,message:(o==null?void 0:o.message)||"File uploaded successfully",data:o==null?void 0:o.data}),p([])}catch(s){n({success:!1,message:(s==null?void 0:s.message)||"Upload failed. Please try again.",errors:s==null?void 0:s.errors})}finally{y(!1)}}},F={accept:c,maxCount:1,fileList:t,beforeUpload:s=>s.size/1024/1024<v?(p([s]),n(null),!1):($.error({title:"File Too Large",content:`File must be smaller than ${v}MB`}),N.LIST_IGNORE),onRemove:()=>{p([]),n(null)}};return e.jsxs("div",{className:"bulk-upload",children:[r&&e.jsxs("div",{className:"template-section",children:[e.jsx(d,{type:"secondary",children:"Download the template file to ensure correct format:"}),e.jsxs(f,{icon:e.jsx(O,{}),onClick:r,className:"template-btn",children:["Download Template (",R,")"]})]}),e.jsxs(K,{...F,className:"upload-dragger",children:[e.jsx("p",{className:"ant-upload-drag-icon",children:e.jsx(_,{style:{color:I.primary,fontSize:48}})}),e.jsx("p",{className:"ant-upload-text",children:U}),e.jsx("p",{className:"ant-upload-hint",children:z}),e.jsx("p",{className:"ant-upload-hint upload-hint-secondary",children:S})]}),t.length>0&&e.jsxs("div",{className:"file-preview",children:[e.jsx(P,{style:{color:I.success,fontSize:24}}),e.jsxs("div",{className:"file-info",children:[e.jsx(d,{strong:!0,children:t[0].name}),e.jsxs(d,{type:"secondary",children:[(t[0].size/1024).toFixed(2)," KB"]})]})]}),h&&e.jsxs("div",{className:"upload-progress",children:[e.jsx(B,{percent:V,status:"active"}),e.jsx(d,{type:"secondary",children:"Uploading and processing..."})]}),a&&e.jsx(M,{message:a.success?"Upload Successful":"Upload Failed",description:e.jsxs("div",{children:[e.jsx("p",{children:a.message}),a.data&&e.jsxs("div",{className:"upload-stats",children:[e.jsxs("span",{children:[e.jsx(w,{})," ",a.data.success||0," records imported"]}),a.data.failed>0&&e.jsxs("span",{children:[e.jsx(E,{})," ",a.data.failed," failed"]})]}),a.errors&&a.errors.length>0&&e.jsxs("div",{className:"upload-errors",children:[e.jsx(d,{strong:!0,children:"Errors:"}),e.jsxs("ul",{children:[a.errors.slice(0,5).map((s,i)=>e.jsx("li",{children:s},i)),a.errors.length>5&&e.jsxs("li",{children:["...and ",a.errors.length-5," more errors"]})]})]})]}),type:a.success?"success":"error",showIcon:!0,closable:!0,onClose:()=>n(null),className:"upload-result"}),e.jsx("div",{className:"upload-actions",children:e.jsxs(H,{children:[e.jsx(f,{type:"primary",onClick:b,disabled:t.length===0,loading:h,size:"large",children:h?"Uploading...":"Upload File"}),t.length>0&&!h&&e.jsx(f,{onClick:()=>p([]),children:"Clear"})]})})]})};export{se as B,ee as R};
