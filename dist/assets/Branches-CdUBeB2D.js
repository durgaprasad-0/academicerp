import{r as s,n as k,j as a,I as y}from"./index-Dam5Oft4.js";import{P}from"./PageHeader-CZTgCyCQ.js";import{D as A}from"./DataTable-CdlHlVvB.js";import{F as D}from"./FormModal-DAw8X4uI.js";import{p as h,c as N,b as T}from"./mockData-Cb9OjNPh.js";/* empty css                 */import{F as c}from"./index-BKD578Au.js";import{T as S}from"./index-B2mNOki0.js";import{C as M}from"./index-FCt6_Que.js";import{S as V}from"./Pagination-Uk28cVne.js";import{S as q}from"./index-ZWRJJm0q.js";import"./ReloadOutlined-DwAtovzj.js";import"./index-DuDzpR4g.js";import"./DeleteOutlined-B7Ves8ci.js";import"./Table-C6DyXLPW.js";import"./index-CrsKlaQM.js";import"./useForm-Boa0LRH0.js";import"./index-B4TLLAPK.js";const i=N(T),te=()=>{const[I,o]=s.useState([]),[f,g]=s.useState(!0),[j,d]=s.useState(!1),[n,x]=s.useState(null),[l]=c.useForm(),{showSuccess:m,showError:u}=k(),b=async()=>{g(!0);try{const e=await i.getAll();o(e.data)}catch{u("Failed to fetch branches")}finally{g(!1)}};s.useEffect(()=>{b()},[]);const F=h.map(e=>({value:e.id,label:`${e.name} (${e.code})`})),v=s.useMemo(()=>[{title:"Branch Name",dataIndex:"name",key:"name",sorter:(e,t)=>e.name.localeCompare(t.name)},{title:"Code",dataIndex:"code",key:"code",width:100,render:e=>a.jsx(S,{color:"blue",children:e})},{title:"Program",dataIndex:"programId",key:"programId",width:200,render:e=>{const t=h.find(r=>r.id===e);return t?t.code:"-"},filters:h.map(e=>({text:e.code,value:e.id})),onFilter:(e,t)=>t.programId===e},{title:"Status",dataIndex:"status",key:"status",width:100,render:e=>a.jsx(S,{color:e==="active"?"success":"default",children:e.charAt(0).toUpperCase()+e.slice(1)})}],[]),C=()=>{x(null),l.resetFields(),d(!0)},B=e=>{x(e),l.setFieldsValue(e),d(!0)},w=async e=>{try{await i.delete(e.id),o(t=>t.filter(r=>r.id!==e.id)),m("Branch deleted successfully")}catch{u("Failed to delete branch")}},E=async e=>{try{if(n){const t=await i.update(n.id,e);o(r=>r.map(p=>p.id===n.id?{...p,...t.data}:p)),m("Branch updated successfully")}else{const t=await i.create(e);o(r=>[...r,t.data]),m("Branch created successfully")}d(!1),l.resetFields()}catch{u("Failed to save branch")}};return a.jsxs("div",{className:"crud-page",children:[a.jsx(P,{title:"Branches",subtitle:"Manage academic branches and departments",onAdd:C,addText:"Add Branch",onRefresh:b,loading:f}),a.jsx(M,{className:"content-card",children:a.jsx(A,{tableId:"branches",columns:v,dataSource:I,loading:f,searchKeys:["name","code"],onEdit:B,onDelete:w,emptyText:"No Branches Found",emptyDescription:"Start by adding your first branch."})}),a.jsxs(D,{title:n?"Edit Branch":"Add New Branch",open:j,onClose:()=>d(!1),onSubmit:E,form:l,initialValues:n||{status:"active"},children:[a.jsx(c.Item,{name:"name",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:a.jsx(y,{placeholder:"e.g., Computer Science and Engineering"})}),a.jsx(c.Item,{name:"code",label:"Branch Code",rules:[{required:!0,message:"Please enter branch code"}],children:a.jsx(y,{placeholder:"e.g., CSE",style:{textTransform:"uppercase"}})}),a.jsx(c.Item,{name:"programId",label:"Program",rules:[{required:!0,message:"Please select a program"}],children:a.jsx(V,{placeholder:"Select program",options:F})}),a.jsx(c.Item,{name:"status",label:"Status",valuePropName:"checked",getValueFromEvent:e=>e?"active":"inactive",getValueProps:e=>({checked:e==="active"}),children:a.jsx(q,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})]})};export{te as default};
