import{r as s,q as k,j as a,n as y,I as S,t as P}from"./index-CV1bxkLI.js";import{P as A}from"./PageHeader-Dveo8Ckr.js";import{D}from"./DataTable-BML9nD9J.js";import{F as N}from"./FormModal-DDGPMrd0.js";import{p,c as M,b as T}from"./mockData-DhN2TBgL.js";/* empty css                 */import{F as c}from"./index-ChYIY3iE.js";import{C as q}from"./index-CJpspubW.js";import{S as V}from"./index-ChaAteEr.js";import"./ReloadOutlined-D_5bXhqo.js";import"./index-D8x57Z7c.js";import"./Table-CQO6drIt.js";import"./index-BHUsVD3h.js";import"./useForm-Dj05K5iH.js";const i=M(T),Z=()=>{const[I,o]=s.useState([]),[f,g]=s.useState(!0),[j,d]=s.useState(!1),[n,x]=s.useState(null),[l]=c.useForm(),{showSuccess:m,showError:u}=k(),b=async()=>{g(!0);try{const e=await i.getAll();o(e.data)}catch{u("Failed to fetch branches")}finally{g(!1)}};s.useEffect(()=>{b()},[]);const F=p.map(e=>({value:e.id,label:`${e.name} (${e.code})`})),v=s.useMemo(()=>[{title:"Branch Name",dataIndex:"name",key:"name",sorter:(e,t)=>e.name.localeCompare(t.name)},{title:"Code",dataIndex:"code",key:"code",width:100,render:e=>a.jsx(y,{color:"blue",children:e})},{title:"Program",dataIndex:"programId",key:"programId",width:200,render:e=>{const t=p.find(r=>r.id===e);return t?t.code:"-"},filters:p.map(e=>({text:e.code,value:e.id})),onFilter:(e,t)=>t.programId===e},{title:"Status",dataIndex:"status",key:"status",width:100,render:e=>a.jsx(y,{color:e==="active"?"success":"default",children:e.charAt(0).toUpperCase()+e.slice(1)})}],[]),C=()=>{x(null),l.resetFields(),d(!0)},B=e=>{x(e),l.setFieldsValue(e),d(!0)},w=async e=>{try{await i.delete(e.id),o(t=>t.filter(r=>r.id!==e.id)),m("Branch deleted successfully")}catch{u("Failed to delete branch")}},E=async e=>{try{if(n){const t=await i.update(n.id,e);o(r=>r.map(h=>h.id===n.id?{...h,...t.data}:h)),m("Branch updated successfully")}else{const t=await i.create(e);o(r=>[...r,t.data]),m("Branch created successfully")}d(!1),l.resetFields()}catch{u("Failed to save branch")}};return a.jsxs("div",{className:"crud-page",children:[a.jsx(A,{title:"Branches",subtitle:"Manage academic branches and departments",onAdd:C,addText:"Add Branch",onRefresh:b,loading:f}),a.jsx(q,{className:"content-card",children:a.jsx(D,{tableId:"branches",columns:v,dataSource:I,loading:f,searchKeys:["name","code"],onEdit:B,onDelete:w,emptyText:"No Branches Found",emptyDescription:"Start by adding your first branch."})}),a.jsxs(N,{title:n?"Edit Branch":"Add New Branch",open:j,onClose:()=>d(!1),onSubmit:E,form:l,initialValues:n||{status:"active"},children:[a.jsx(c.Item,{name:"name",label:"Branch Name",rules:[{required:!0,message:"Please enter branch name"}],children:a.jsx(S,{placeholder:"e.g., Computer Science and Engineering"})}),a.jsx(c.Item,{name:"code",label:"Branch Code",rules:[{required:!0,message:"Please enter branch code"}],children:a.jsx(S,{placeholder:"e.g., CSE",style:{textTransform:"uppercase"}})}),a.jsx(c.Item,{name:"programId",label:"Program",rules:[{required:!0,message:"Please select a program"}],children:a.jsx(P,{placeholder:"Select program",options:F})}),a.jsx(c.Item,{name:"status",label:"Status",valuePropName:"checked",getValueFromEvent:e=>e?"active":"inactive",getValueProps:e=>({checked:e==="active"}),children:a.jsx(V,{checkedChildren:"Active",unCheckedChildren:"Inactive"})})]})]})};export{Z as default};
