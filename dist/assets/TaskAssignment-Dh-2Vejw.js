import{r as u,q as H,j as e,x as k,T as V,S as y,H as K,J as L,n as T,M as D,B as p,N as b,O as G,G as J,h as x,C as a,Q as h,I as S,t as c,U as I}from"./index-CV1bxkLI.js";import{P as Q}from"./PageHeader-Dveo8Ckr.js";import{D as W}from"./DataTable-BML9nD9J.js";import{F as X}from"./FormModal-DDGPMrd0.js";import{u as Z}from"./useTaskStore-B53TV6IO.js";import{f as w,d as C}from"./mockData-DhN2TBgL.js";/* empty css                 */import{F as l}from"./index-ChYIY3iE.js";import{P as ee}from"./index-D8x57Z7c.js";import{C as j}from"./index-CJpspubW.js";import{D as se}from"./index-BVAu8cRu.js";import"./ReloadOutlined-D_5bXhqo.js";import"./Table-CQO6drIt.js";import"./index-BHUsVD3h.js";import"./useForm-Dj05K5iH.js";import"./CalendarOutlined-Bu7k27zF.js";const{Text:g}=V,{TextArea:te}=S,ke=()=>{const[A,i]=u.useState(!1),[m,f]=u.useState(null),[o]=l.useForm(),{showSuccess:r}=H(),{tasks:d,addTask:P,updateTask:F,deleteTask:M,updateTaskStatus:v}=Z(),z=[{value:"low",label:"Low"},{value:"medium",label:"Medium"},{value:"high",label:"High"}],B=[{value:"pending",label:"Pending"},{value:"in_progress",label:"In Progress"},{value:"completed",label:"Completed"}],E=u.useMemo(()=>[{title:"Task",dataIndex:"title",key:"title",width:250,render:(s,t)=>e.jsxs("div",{children:[e.jsx(g,{strong:!0,children:s}),e.jsx("br",{}),e.jsx(g,{type:"secondary",style:{fontSize:12},children:t.courseName})]})},{title:"Assigned To",dataIndex:"assignedTo",key:"assignedTo",width:180,render:s=>{const t=w.find(n=>n.id===s);return t?e.jsxs(y,{children:[e.jsx(K,{size:"small",style:{backgroundColor:"#4E73DF"},children:L(t.name)}),e.jsx(g,{children:t.name})]}):"-"}},{title:"Priority",dataIndex:"priority",key:"priority",width:100,render:s=>{const t={low:"default",medium:"warning",high:"error"};return e.jsx(T,{color:t[s],children:s.toUpperCase()})}},{title:"Due Date",dataIndex:"dueDate",key:"dueDate",width:120,render:s=>s?k(s).format("DD MMM YYYY"):"-"},{title:"Status",dataIndex:"status",key:"status",width:120,render:s=>{const t={pending:{color:"warning",icon:e.jsx(I,{})},in_progress:{color:"processing",icon:e.jsx(I,{})},completed:{color:"success",icon:e.jsx(b,{})}},n=t[s]||t.pending;return e.jsx(T,{color:n.color,icon:n.icon,children:s.replace("_"," ").toUpperCase()})}},{title:"Actions",key:"actions",width:150,render:(s,t)=>e.jsxs(y,{size:"small",children:[t.status!=="completed"&&e.jsx(D,{title:"Mark Complete",children:e.jsx(p,{type:"text",size:"small",icon:e.jsx(b,{style:{color:"#00B894"}}),onClick:()=>{v(t.id,"completed"),r("Task marked as completed")}})}),e.jsx(D,{title:"Edit",children:e.jsx(p,{type:"text",size:"small",icon:e.jsx(G,{}),onClick:()=>Y(t)})}),e.jsx(ee,{title:"Delete this task?",onConfirm:()=>$(t),okText:"Delete",okButtonProps:{danger:!0},children:e.jsx(p,{type:"text",size:"small",danger:!0,icon:e.jsx(J,{})})})]})}],[]),R=()=>{f(null),o.resetFields(),i(!0)},Y=s=>{f(s),o.setFieldsValue({...s,dueDate:s.dueDate?k(s.dueDate):null}),i(!0)},$=s=>{M(s.id),r("Task deleted")},N=async s=>{var n;const t={...s,dueDate:s.dueDate?s.dueDate.format("YYYY-MM-DD"):null,courseName:((n=C.find(U=>U.id===s.courseId))==null?void 0:n.name)||"",assignedBy:"Admin"};m?(F(m.id,t),r("Task updated")):(P(t),r("Task assigned")),i(!1),o.resetFields()},O=d.filter(s=>s.status==="pending").length,_=d.filter(s=>s.status==="in_progress").length,q=d.filter(s=>s.status==="completed").length;return e.jsxs("div",{className:"crud-page",children:[e.jsx(Q,{title:"Task Assignment",subtitle:"Assign and manage tasks for faculty members",onAdd:R,addLabel:"Assign Task",showRefresh:!1}),e.jsxs(x,{gutter:16,style:{marginBottom:16},children:[e.jsx(a,{span:8,children:e.jsx(j,{size:"small",children:e.jsx(h,{color:"#F59E0B",text:`${O} Pending`})})}),e.jsx(a,{span:8,children:e.jsx(j,{size:"small",children:e.jsx(h,{color:"#4E73DF",text:`${_} In Progress`})})}),e.jsx(a,{span:8,children:e.jsx(j,{size:"small",children:e.jsx(h,{color:"#00B894",text:`${q} Completed`})})})]}),e.jsx(W,{tableId:"task-assignment",dataSource:d,columns:E,rowKey:"id",searchKeys:["title","courseName"],showActions:!1}),e.jsxs(X,{title:m?"Edit Task":"Assign New Task",open:A,onClose:()=>i(!1),onSubmit:N,form:o,width:600,children:[e.jsx(l.Item,{name:"title",label:"Task Title",rules:[{required:!0,message:"Please enter task title"}],children:e.jsx(S,{placeholder:"e.g., Add questions for Unit 3"})}),e.jsx(l.Item,{name:"description",label:"Description",children:e.jsx(te,{rows:3,placeholder:"Provide details about the task..."})}),e.jsxs(x,{gutter:16,children:[e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"assignedTo",label:"Assign To",rules:[{required:!0,message:"Please select faculty"}],children:e.jsx(c,{placeholder:"Select faculty",options:w.filter(s=>s.status==="active").map(s=>({value:s.id,label:s.name}))})})}),e.jsx(a,{span:12,children:e.jsx(l.Item,{name:"courseId",label:"Related Course",children:e.jsx(c,{placeholder:"Select course (optional)",allowClear:!0,options:C.map(s=>({value:s.id,label:`${s.name} (${s.code})`}))})})})]}),e.jsxs(x,{gutter:16,children:[e.jsx(a,{span:8,children:e.jsx(l.Item,{name:"priority",label:"Priority",initialValue:"medium",children:e.jsx(c,{options:z})})}),e.jsx(a,{span:8,children:e.jsx(l.Item,{name:"status",label:"Status",initialValue:"pending",children:e.jsx(c,{options:B})})}),e.jsx(a,{span:8,children:e.jsx(l.Item,{name:"dueDate",label:"Due Date",children:e.jsx(se,{style:{width:"100%"}})})})]})]})]})};export{ke as default};
