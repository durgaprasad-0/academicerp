import{r as o,g as P,_ as y,b as z,d as x,j as e,T as N,I as i,ch as d,e as m,B as j}from"./index-CV1bxkLI.js";import{P as E}from"./PageHeader-Dveo8Ckr.js";import{F as g}from"./FormLayout-Ba_DKE1N.js";import{F as l}from"./index-ChYIY3iE.js";import{C as I}from"./index-CJpspubW.js";import{A as S}from"./index-DJSLK9Tr.js";import{P as F}from"./progress-BAB7NLHo.js";import"./ReloadOutlined-D_5bXhqo.js";import"./useForm-Dj05K5iH.js";var R={icon:function(a,t){return{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M81.8 537.8a60.3 60.3 0 010-51.5C176.6 286.5 319.8 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c-192.1 0-335.4-100.5-430.2-300.2z",fill:t}},{tag:"path",attrs:{d:"M512 258c-161.3 0-279.4 81.8-362.7 254C232.6 684.2 350.7 766 512 766c161.4 0 279.5-81.8 362.7-254C791.4 339.8 673.3 258 512 258zm-4 430c-97.2 0-176-78.8-176-176s78.8-176 176-176 176 78.8 176 176-78.8 176-176 176z",fill:t}},{tag:"path",attrs:{d:"M942.2 486.2C847.4 286.5 704.1 186 512 186c-192.2 0-335.4 100.5-430.2 300.3a60.3 60.3 0 000 51.5C176.6 737.5 319.9 838 512 838c192.2 0 335.4-100.5 430.2-300.3 7.7-16.2 7.7-35 0-51.5zM512 766c-161.3 0-279.4-81.8-362.7-254C232.6 339.8 350.7 258 512 258s279.4 81.8 362.7 254C791.5 684.2 673.4 766 512 766z",fill:a}},{tag:"path",attrs:{d:"M508 336c-97.2 0-176 78.8-176 176s78.8 176 176 176 176-78.8 176-176-78.8-176-176-176zm0 288c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z",fill:a}}]}},name:"eye",theme:"twotone"},T=function(a,t){return o.createElement(P,y({},a,{ref:t,icon:R}))},u=o.forwardRef(T),A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M866.9 169.9L527.1 54.1C523 52.7 517.5 52 512 52s-11 .7-15.1 2.1L157.1 169.9c-8.3 2.8-15.1 12.4-15.1 21.2v482.4c0 8.8 5.7 20.4 12.6 25.9L499.3 968c3.5 2.7 8 4.1 12.6 4.1s9.2-1.4 12.6-4.1l344.7-268.6c6.9-5.4 12.6-17 12.6-25.9V191.1c.2-8.8-6.6-18.3-14.9-21.2zM810 654.3L512 886.5 214 654.3V226.7l298-101.6 298 101.6v427.6zm-405.8-201c-3-4.1-7.8-6.6-13-6.6H336c-6.5 0-10.3 7.4-6.5 12.7l126.4 174a16.1 16.1 0 0026 0l212.6-292.7c3.8-5.3 0-12.7-6.5-12.7h-55.2c-5.1 0-10 2.5-13 6.6L468.9 542.4l-64.7-89.1z"}}]},name:"safety-certificate",theme:"outlined"},M=function(a,t){return o.createElement(P,y({},a,{ref:t,icon:A}))},L=o.forwardRef(M);const{Text:w}=N,V=()=>{const[n]=l.useForm(),{changePassword:a,isLoading:t}=z(),[r,h]=o.useState(""),[C,f]=o.useState(!1),c=o.useMemo(()=>{if(!r)return{score:0,label:"",color:""};let s=0;return r.length>=8&&(s+=25),/[a-z]/.test(r)&&(s+=25),/[A-Z]/.test(r)&&(s+=25),/[0-9]/.test(r)&&(s+=15),/[^a-zA-Z0-9]/.test(r)&&(s+=10),s<40?{score:s,label:"Weak",color:"#EF4444"}:s<70?{score:s,label:"Medium",color:"#F59E0B"}:{score:s,label:"Strong",color:x.accent}},[r]),b=async s=>{(await a(s.currentPassword,s.newPassword)).success&&(f(!0),n.resetFields(),h(""),setTimeout(()=>f(!1),5e3))};return e.jsxs("div",{className:"change-password-page",children:[e.jsx(E,{title:"Change Password",subtitle:"Update your account password",showAdd:!1,showRefresh:!1}),e.jsxs(I,{className:"password-card",children:[C&&e.jsx(S,{message:"Password Changed Successfully",description:"Your password has been updated. Use your new password for future logins.",type:"success",showIcon:!0,closable:!0,style:{marginBottom:24}}),e.jsxs("div",{className:"password-icon-header",children:[e.jsx("div",{className:"password-icon-wrapper",children:e.jsx(L,{style:{fontSize:48,color:x.primary}})}),e.jsx(w,{type:"secondary",children:"For your security, please enter your current password and choose a new strong password."})]}),e.jsxs(g,{form:n,onFinish:b,children:[e.jsx(l.Item,{name:"currentPassword",label:"Current Password",rules:[{required:!0,message:"Please enter your current password"}],children:e.jsx(i.Password,{prefix:e.jsx(m,{}),placeholder:"Enter current password",iconRender:s=>s?e.jsx(u,{}):e.jsx(d,{})})}),e.jsx(l.Item,{name:"newPassword",label:"New Password",rules:[{required:!0,message:"Please enter a new password"},{min:8,message:"Password must be at least 8 characters"}],children:e.jsx(i.Password,{prefix:e.jsx(m,{}),placeholder:"Enter new password",iconRender:s=>s?e.jsx(u,{}):e.jsx(d,{}),onChange:s=>h(s.target.value)})}),r&&e.jsxs("div",{className:"password-strength",children:[e.jsxs("div",{className:"strength-header",children:[e.jsx(w,{type:"secondary",children:"Password Strength:"}),e.jsx(w,{strong:!0,style:{color:c.color},children:c.label})]}),e.jsx(F,{percent:c.score,showInfo:!1,strokeColor:c.color,size:"small"}),e.jsxs("ul",{className:"password-requirements",children:[e.jsx("li",{className:r.length>=8?"met":"",children:"At least 8 characters"}),e.jsx("li",{className:/[a-z]/.test(r)?"met":"",children:"One lowercase letter"}),e.jsx("li",{className:/[A-Z]/.test(r)?"met":"",children:"One uppercase letter"}),e.jsx("li",{className:/[0-9]/.test(r)?"met":"",children:"One number"}),e.jsx("li",{className:/[^a-zA-Z0-9]/.test(r)?"met":"",children:"One special character"})]})]}),e.jsx(l.Item,{name:"confirmPassword",label:"Confirm New Password",dependencies:["newPassword"],rules:[{required:!0,message:"Please confirm your new password"},({getFieldValue:s})=>({validator(v,p){return!p||s("newPassword")===p?Promise.resolve():Promise.reject(new Error("Passwords do not match"))}})],children:e.jsx(i.Password,{prefix:e.jsx(m,{}),placeholder:"Confirm new password",iconRender:s=>s?e.jsx(u,{}):e.jsx(d,{})})}),e.jsxs(g.Actions,{children:[e.jsx(j,{onClick:()=>n.resetFields(),children:"Cancel"}),e.jsx(j,{type:"primary",htmlType:"submit",loading:t,children:"Update Password"})]})]})]})]})};export{V as default};
