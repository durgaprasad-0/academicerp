import{r,n as E,j as e,ax as T,B as I,ay as L}from"./index-Dam5Oft4.js";import{P as N}from"./PageHeader-CZTgCyCQ.js";import{p as i,e as b,b as A}from"./mockData-Cb9OjNPh.js";/* empty css                 */import{R as k}from"./SaveOutlined-BGTQrFeS.js";import{R as z,a as h,C as x,T as $}from"./index-FCt6_Que.js";import{L as c}from"./index-DLj7NG8w.js";import{T as f}from"./index-B2mNOki0.js";import{C as F}from"./index-CrsKlaQM.js";import{E as H}from"./Pagination-Uk28cVne.js";import"./ReloadOutlined-DwAtovzj.js";const{Text:o}=$,Y=()=>{var g;const[u,j]=r.useState(!0),[y,l]=r.useState(!1),[a,d]=r.useState(null),[m,p]=r.useState({}),{showSuccess:S,showError:P}=E();r.useEffect(()=>{const s={};i.forEach(n=>{s[n.id]=b.filter(t=>t.programId===n.id).map(t=>t.branchId)}),p(s),j(!1),i.length>0&&d(i[0].id)},[]);const v=s=>{d(s)},B=s=>{a&&p(n=>{const t=n[a]||[],R=t.includes(s);return{...n,[a]:R?t.filter(w=>w!==s):[...t,s]}})},C=async()=>{l(!0);try{await new Promise(s=>setTimeout(s,1e3)),S("Mappings saved successfully")}catch{P("Failed to save mappings")}finally{l(!1)}},M=a?m[a]||[]:[];return u?e.jsx("div",{className:"crud-page",style:{textAlign:"center",padding:100},children:e.jsx(T,{size:"large"})}):e.jsxs("div",{className:"crud-page",children:[e.jsx(N,{title:"Program-Branch Mapping",subtitle:"Assign branches to academic programs",showAdd:!1,showRefresh:!1,extra:e.jsx(I,{type:"primary",icon:e.jsx(k,{}),onClick:C,loading:y,children:"Save Mappings"})}),e.jsxs(z,{gutter:24,children:[e.jsx(h,{xs:24,md:10,children:e.jsx(x,{title:"Programs",className:"mapping-panel",size:"small",children:e.jsx(c,{dataSource:i,renderItem:s=>e.jsxs(c.Item,{className:`mapping-item ${a===s.id?"selected":""}`,onClick:()=>v(s.id),children:[e.jsxs("div",{children:[e.jsx(o,{strong:!0,children:s.name}),e.jsx("br",{}),e.jsx(o,{type:"secondary",style:{fontSize:12},children:s.code})]}),e.jsxs(f,{color:"blue",children:[(m[s.id]||[]).length," branches"]})]})})})}),e.jsx(h,{xs:24,md:14,children:e.jsx(x,{title:e.jsxs("span",{children:[e.jsx(L,{style:{marginRight:8}}),"Assign Branches",a&&e.jsxs(o,{type:"secondary",style:{fontWeight:"normal",marginLeft:8},children:["to ",(g=i.find(s=>s.id===a))==null?void 0:g.name]})]}),className:"assignment-panel",size:"small",children:a?e.jsx(c,{dataSource:A,renderItem:s=>e.jsx(c.Item,{className:"assignment-item",children:e.jsx(F,{checked:M.includes(s.id),onChange:()=>B(s.id),children:e.jsxs("span",{style:{marginLeft:8},children:[s.name,e.jsx(f,{style:{marginLeft:8},children:s.code})]})})})}):e.jsx(H,{description:"Select a program to assign branches"})})})]})]})};export{Y as default};
