import{r,n as B,j as s,B as m,I as $}from"./index-Dam5Oft4.js";import{P as z}from"./PageHeader-CZTgCyCQ.js";import{F as M}from"./FormModal-DAw8X4uI.js";import{d as P,j as v,c as q,k as V}from"./mockData-Cb9OjNPh.js";/* empty css                 */import{F as u}from"./index-BKD578Au.js";import{T as j}from"./index-B2mNOki0.js";import{d as G,R as H,a as w,C as S,T as K,c as W}from"./index-FCt6_Que.js";import{R as _}from"./DeleteOutlined-B7Ves8ci.js";import{F as J}from"./Table-C6DyXLPW.js";import{S as F}from"./Pagination-Uk28cVne.js";import"./ReloadOutlined-DwAtovzj.js";import"./index-B4TLLAPK.js";import"./useForm-Boa0LRH0.js";import"./index-CrsKlaQM.js";const{Text:C}=K,p=q(V),ce=()=>{const[k,N]=r.useState(!0),[l,y]=r.useState(null),[b,n]=r.useState([]),[L,d]=r.useState(!1),[a,g]=r.useState(null),[i]=u.useForm(),{showSuccess:h,showError:x}=B(),c=P.slice(0,5);r.useEffect(()=>{(async()=>{try{const t=await p.getAll();n(t.data)}catch{x("Failed to fetch course outcomes")}finally{N(!1)}})(),c.length>0&&y(c[0].id)},[]);const I=b.filter(e=>e.courseId===l),T=r.useMemo(()=>[{title:"CO Number",dataIndex:"coNumber",key:"coNumber",width:100,render:e=>s.jsxs(j,{color:"blue",children:["CO",e]})},{title:"Description",dataIndex:"description",key:"description"},{title:"Bloom Level",dataIndex:"bloomLevelId",key:"bloomLevelId",width:150,render:e=>{const t=v.find(o=>o.id===e);return t?s.jsx(j,{color:"purple",children:t.name}):"-"}},{title:"Actions",key:"actions",width:100,render:(e,t)=>s.jsxs(m.Group,{size:"small",children:[s.jsx(m,{type:"text",icon:s.jsx(G,{}),onClick:()=>R(t)}),s.jsx(m,{type:"text",danger:!0,icon:s.jsx(_,{}),onClick:()=>D(t)})]})}],[]),A=()=>{g(null),i.resetFields(),i.setFieldsValue({courseId:l}),d(!0)},R=e=>{g(e),i.setFieldsValue(e),d(!0)},D=async e=>{try{await p.delete(e.id),n(t=>t.filter(o=>o.id!==e.id)),h("Course outcome deleted")}catch{x("Failed to delete")}},E=async e=>{try{if(a){const t=await p.update(a.id,e);n(o=>o.map(f=>f.id===a.id?{...f,...t.data}:f)),h("Course outcome updated")}else{const t=await p.create({...e,courseId:l});n(o=>[...o,t.data]),h("Course outcome added")}d(!1),i.resetFields()}catch{x("Failed to save")}},O=c.find(e=>e.id===l);return s.jsxs("div",{className:"crud-page",children:[s.jsx(z,{title:"Course Outcomes",subtitle:"Define learning outcomes for your courses",showAdd:!1,showRefresh:!1}),s.jsxs(H,{gutter:24,children:[s.jsx(w,{xs:24,md:8,children:s.jsx(S,{title:"My Courses",size:"small",children:c.map(e=>s.jsxs("div",{className:`mapping-item ${l===e.id?"selected":""}`,onClick:()=>y(e.id),children:[s.jsxs("div",{children:[s.jsx(C,{strong:!0,children:e.name}),s.jsx("br",{}),s.jsx(C,{type:"secondary",style:{fontSize:12},children:e.code})]}),s.jsxs(j,{children:[b.filter(t=>t.courseId===e.id).length," COs"]})]},e.id))})}),s.jsx(w,{xs:24,md:16,children:s.jsx(S,{title:s.jsxs("span",{children:["Course Outcomes",O&&s.jsxs(C,{type:"secondary",style:{fontWeight:"normal",marginLeft:8},children:["for ",O.name]})]}),extra:s.jsx(m,{type:"primary",icon:s.jsx(W,{}),onClick:A,disabled:!l,children:"Add CO"}),size:"small",children:s.jsx(J,{dataSource:I,columns:T,rowKey:"id",loading:k,pagination:!1,size:"small",locale:{emptyText:"No course outcomes defined for this course"}})})})]}),s.jsxs(M,{title:a?"Edit Course Outcome":"Add Course Outcome",open:L,onClose:()=>d(!1),onSubmit:E,form:i,initialValues:a||{coNumber:I.length+1},children:[s.jsx(u.Item,{name:"coNumber",label:"CO Number",rules:[{required:!0,message:"Please enter CO number"}],children:s.jsx(F,{placeholder:"Select CO number",options:[1,2,3,4,5,6].map(e=>({value:e,label:`CO${e}`}))})}),s.jsx(u.Item,{name:"description",label:"Description",rules:[{required:!0,message:"Please enter CO description"}],children:s.jsx($.TextArea,{rows:3,placeholder:"Describe what students will be able to do after completing this course"})}),s.jsx(u.Item,{name:"bloomLevelId",label:"Bloom's Taxonomy Level",rules:[{required:!0,message:"Please select Bloom level"}],children:s.jsx(F,{placeholder:"Select Bloom level",options:v.map(e=>({value:e.id,label:`${e.name} (Level ${e.level})`}))})})]})]})};export{ce as default};
